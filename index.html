<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Deepak SMM | Professional Panel</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <script src="https://www.gstatic.com/firebasejs/9.17.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.17.1/firebase-database-compat.js"></script>

    <style>
        body { background-color: #0b1120; color: #e2e8f0; font-family: 'Inter', sans-serif; }
        .glass { background: rgba(30, 41, 59, 0.7); backdrop-filter: blur(12px); border: 1px solid rgba(255,255,255,0.05); }
        .btn-grad { background: linear-gradient(90deg, #6366f1, #ec4899); }
        .hidden { display: none !important; }
    </style>
</head>
<body>

    <nav class="sticky top-0 w-full z-50 glass px-6 py-4 flex justify-between items-center border-b border-slate-800">
        <div class="flex items-center gap-2">
            <i class="fa-solid fa-bolt text-indigo-500 text-2xl"></i>
            <span class="font-bold text-xl uppercase text-white">Deepak<span class="text-indigo-500">SMM</span></span>
        </div>
        <div id="user-info" class="hidden flex items-center gap-4">
            <span id="top-balance" class="text-green-400 font-bold">â‚¹0.00</span>
            <button onclick="logout()" class="text-slate-400"><i class="fa-solid fa-power-off"></i></button>
        </div>
    </nav>

    <main class="pt-10 px-4 max-w-5xl mx-auto">
        <div id="home-view" class="text-center py-20">
            <h1 class="text-5xl font-black mb-6">Deepak <span class="text-indigo-500">SMM</span></h1>
            <button onclick="document.getElementById('reg-modal').classList.remove('hidden')" class="btn-grad px-12 py-5 rounded-2xl font-black text-xl">Get Started</button>
        </div>

        <div id="dash-view" class="hidden">
            <div class="glass p-8 rounded-3xl border border-indigo-500/10">
                <h2 class="text-2xl font-bold mb-6 text-indigo-400">Add Balance (QR)</h2>
                <div class="bg-white p-4 inline-block rounded-2xl mb-4">
                    <img src="https://api.qrserver.com/v1/create-qr-code/?size=200x200&data=upi://pay?pa=9769073299@axl&pn=DeepakSMM" class="w-48 h-48">
                </div>
                <input id="utr-input" type="text" placeholder="Enter UTR Number" class="w-full bg-slate-900 p-4 rounded-xl mb-4 outline-none border border-slate-700">
                <button onclick="whatsappPay()" class="w-full bg-green-600 py-4 rounded-xl font-black">Submit on WhatsApp</button>
            </div>
        </div>
    </main>

    <div id="reg-modal" class="fixed inset-0 bg-black/90 z-[100] hidden flex items-center justify-center p-6">
        <div class="glass p-8 rounded-3xl w-full max-w-md border border-slate-700">
            <h2 class="text-2xl font-bold mb-6 text-indigo-400 text-center">Register / Login</h2>
            <input id="r-name" type="text" placeholder="Full Name" class="w-full bg-slate-800 p-4 rounded-xl mb-4 outline-none border border-slate-700">
            <input id="r-email" type="email" placeholder="Gmail" class="w-full bg-slate-800 p-4 rounded-xl mb-4 outline-none border border-slate-700">
            <input id="r-pass" type="password" placeholder="Password" class="w-full bg-slate-800 p-4 rounded-xl mb-6 outline-none border border-slate-700">
            <button onclick="registerUser()" class="w-full btn-grad py-4 rounded-xl font-bold">Submit</button>
        </div>
    </div>

    <div id="admin-modal" class="fixed inset-0 bg-black/95 z-[101] hidden flex items-center justify-center p-6 text-center">
        <div class="glass p-8 rounded-3xl w-full max-w-md border-2 border-indigo-500">
            <h2 class="text-xl font-black text-indigo-400 mb-6">ADMIN CLOUD PANEL</h2>
            <input id="adm-email" type="email" placeholder="User Gmail" class="w-full bg-slate-800 p-4 rounded-xl mb-4 outline-none border border-slate-700">
            <input id="adm-amt" type="number" placeholder="Amount (â‚¹)" class="w-full bg-slate-800 p-4 rounded-xl mb-4 outline-none border border-slate-700">
            <button onclick="adminAdd()" class="w-full bg-indigo-600 py-3 rounded-xl font-bold mb-4">ADD BALANCE</button>
            <button onclick="viewAllUsers()" class="w-full bg-yellow-600 py-3 rounded-xl font-bold text-black mb-4 uppercase">View All Registered Users</button>
            <div id="user-list-display" class="mt-4 text-left text-xs max-h-40 overflow-y-auto hidden bg-black p-3 rounded-lg text-yellow-500 font-mono"></div>
            <button onclick="document.getElementById('admin-modal').classList.add('hidden')" class="mt-4 text-slate-500">Close</button>
        </div>
    </div>

    <div onclick="openAdmin()" class="fixed bottom-4 right-4 opacity-20 cursor-pointer text-xl"><i class="fa-solid fa-gear"></i></div>

    <script>
        // AAPKA FIREBASE CONFIG
        const firebaseConfig = {
            apiKey: "AIzaSyB2_FEeqonZMSaoMnd_pjZNFLfBGir4_AE",
            authDomain: "deepaksmm-dc3ec.firebaseapp.com",
            projectId: "deepaksmm-dc3ec",
            storageBucket: "deepaksmm-dc3ec.firebasestorage.app",
            messagingSenderId: "759682230527",
            appId: "1:759682230527:web:9d7b0bcdd6e1f0efb044ca",
            databaseURL: "https://deepaksmm-dc3ec-default-rtdb.firebaseio.com"
        };

        firebase.initializeApp(firebaseConfig);
        const db = firebase.database();

        async function registerUser() {
            const n = document.getElementById('r-name').value, e = document.getElementById('r-email').value, p = document.getElementById('r-pass').value;
            if(!e || !p) return alert("Email & Pass required!");
            const userKey = btoa(e).replace(/=/g, "");
            const snapshot = await db.ref('users/' + userKey).once('value');
            if(snapshot.exists()) {
                if(snapshot.val().pass === p) {
                    localStorage.setItem('deepak_session_email', e);
                    location.reload();
                } else { alert("Wrong Password!"); }
            } else {
                await db.ref('users/' + userKey).set({ name: n, email: e, pass: p, balance: 0.00 });
                localStorage.setItem('deepak_session_email', e);
                location.reload();
            }
        }

        async function adminAdd() {
            const email = document.getElementById('adm-email').value, amt = parseFloat(document.getElementById('adm-amt').value);
            const userKey = btoa(email).replace(/=/g, "");
            const userRef = db.ref('users/' + userKey);
            const snapshot = await userRef.once('value');
            if(snapshot.exists()) {
                const currentBal = snapshot.val().balance || 0;
                await userRef.update({ balance: currentBal + amt });
                alert("â‚¹" + amt + " added to " + email);
                location.reload();
            } else { alert("User Not Found!"); }
        }

        async function viewAllUsers() {
            const display = document.getElementById('user-list-display');
            display.classList.toggle('hidden');
            const snapshot = await db.ref('users').once('value');
            const data = snapshot.val();
            let html = "";
            for(let key in data) { html += `ðŸ‘¤ ${data[key].name} | ðŸ“§ ${data[key].email} | ðŸ”‘ ${data[key].pass} | ðŸ’° â‚¹${data[key].balance}<br><br>`; }
            display.innerHTML = html || "No users yet.";
        }

        function openAdmin() { if(prompt("Admin Password?") === "admin123") document.getElementById('admin-modal').classList.remove('hidden'); }
        function logout() { localStorage.removeItem('deepak_session_email'); location.reload(); }
        function whatsappPay() { window.open(`https://wa.me/919250996142?text=PaymentUTR:${document.getElementById('utr-input').value}`, '_blank'); }

        async function init() {
            const email = localStorage.getItem('deepak_session_email');
            if(email) {
                const snapshot = await db.ref('users/' + btoa(email).replace(/=/g, "")).once('value');
                if(snapshot.exists()) {
                    const session = snapshot.val();
                    document.getElementById('home-view').classList.add('hidden');
                    document.getElementById('dash-view').classList.remove('hidden');
                    document.getElementById('user-info').classList.remove('hidden');
                    document.getElementById('top-balance').innerText = "â‚¹" + session.balance.toFixed(2);
                }
            }
        }
        init();
    </script>
</body>
</html>
